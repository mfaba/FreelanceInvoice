<div class="container-fluid py-5">
    <div class="container py-5">
        <div class="row">
            <div class="col-12">
                <div class="bg-white rounded shadow-sm p-5">
                    <!-- Header -->
                    <div class="d-flex justify-content-between align-items-center mb-5">
                        <div>
                            <h2 class="text-primary mb-2">{{ isEditMode ? 'Edit Client' : 'Create Client' }}</h2>
                            <p class="text-muted">Fill in the details to {{ isEditMode ? 'update' : 'create' }} your client</p>
                        </div>
                        <button
                            type="button"
                            class="btn btn-outline-secondary rounded-pill px-4"
                            routerLink="/clients">
                            <i class="fas fa-times me-2"></i>Cancel
                        </button>
                    </div>

                    <form [formGroup]="clientForm" (ngSubmit)="onSubmit()" class="needs-validation" novalidate>
                        <!-- Basic Information -->
                        <div class="card mb-4">
                            <div class="card-header bg-light">
                                <h5 class="card-title mb-0">Basic Information</h5>
                            </div>
                            <div class="card-body">
                                <div class="row g-3">
                                    <!-- Name -->
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <input
                                                type="text"
                                                class="form-control"
                                                id="name"
                                                formControlName="name"
                                                placeholder="Client Name"
                                                required
                                            />
                                            <label for="name">Name *</label>
                                            <div *ngIf="name?.invalid && name?.touched" class="text-danger small mt-1">
                                                <div *ngIf="name?.errors?.['required']">Name is required</div>
                                                <div *ngIf="name?.errors?.['minlength']">Name must be at least 2 characters</div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Email -->
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <input
                                                type="email"
                                                class="form-control"
                                                id="email"
                                                formControlName="email"
                                                placeholder="Email Address"
                                                required
                                            />
                                            <label for="email">Email *</label>
                                            <div *ngIf="email?.invalid && email?.touched" class="text-danger small mt-1">
                                                <div *ngIf="email?.errors?.['required']">Email is required</div>
                                                <div *ngIf="email?.errors?.['email']">Please enter a valid email address</div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Phone -->
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <ngx-intl-tel-input
                                                [cssClass]="'form-control'"
                                                [preferredCountries]="phoneConfig.preferredCountries"
                                                [enablePlaceholder]="phoneConfig.enablePlaceholder"
                                                [customPlaceholder]="phoneConfig.customPlaceholder"
                                                [separateDialCode]="phoneConfig.separateDialCode"
                                                [numberFormat]="phoneConfig.numberFormat"
                                                [searchCountryFlag]="phoneConfig.searchCountryFlag"
                                                [searchCountryField]="phoneConfig.searchCountryField"
                                                formControlName="phone"
                                                
                                                inputId="phone">
                                            </ngx-intl-tel-input>
                                             <div *ngIf="phone?.invalid && phone?.touched" class="text-danger small mt-1">
                                                <div *ngIf="phone?.errors?.['required']">Phone number is required</div>
                                                <div *ngIf="phone?.errors?.['validatePhoneNumber']">Please enter a valid phone number</div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Tax ID -->
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <input
                                                type="text"
                                                class="form-control"
                                                id="taxId"
                                                formControlName="taxId"
                                                placeholder="Tax ID"
                                            />
                                            <label for="taxId">Tax ID</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Address -->
                        <div class="card mb-4" formGroupName="address">
                            <div class="card-header bg-light">
                                <h5 class="card-title mb-0">Address</h5>
                            </div>
                            <div class="card-body">
                                <div class="row g-3">
                                    <!-- Street -->
                                    <div class="col-12">
                                        <div class="form-floating">
                                            <input
                                                type="text"
                                                class="form-control"
                                                id="street"
                                                formControlName="street"
                                                placeholder="Street Address"
                                            />
                                            <label for="street">Street</label>
                                        </div>
                                    </div>

                                    <!-- City, State, Zip -->
                                    <div class="col-md-4">
                                        <div class="form-floating">
                                            <input
                                                type="text"
                                                class="form-control"
                                                id="city"
                                                formControlName="city"
                                                placeholder="City"
                                            />
                                            <label for="city">City</label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-floating">
                                            <input
                                                type="text"
                                                class="form-control"
                                                id="state"
                                                formControlName="state"
                                                placeholder="State"
                                            />
                                            <label for="state">State</label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-floating">
                                            <input
                                                type="text"
                                                class="form-control"
                                                id="zipCode"
                                                formControlName="zipCode"
                                                placeholder="ZIP Code"
                                            />
                                            <label for="zipCode">ZIP Code</label>
                                        </div>
                                    </div>

                                    <!-- Country -->
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <input
                                                type="text"
                                                class="form-control"
                                                id="country"
                                                formControlName="country"
                                                placeholder="Country"
                                            />
                                            <label for="country">Country</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Additional Information -->
                        <div class="card mb-4">
                            <div class="card-header bg-light">
                                <h5 class="card-title mb-0">Additional Information</h5>
                            </div>
                            <div class="card-body">
                                <div class="row g-3">
                                    <!-- Notes -->
                                    <div class="col-12">
                                        <div class="form-floating">
                                            <textarea
                                                class="form-control"
                                                id="notes"
                                                formControlName="notes"
                                                placeholder="Notes"
                                                style="height: 100px"
                                            ></textarea>
                                            <label for="notes">Notes</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Form Actions -->
                        <div class="d-flex justify-content-end gap-3">
                            <button
                                type="button"
                                routerLink="/clients"
                                class="btn btn-outline-secondary rounded-pill px-4">
                                Cancel
                            </button>
                            <button
                                type="submit"
                                [disabled]="clientForm.invalid || isLoading"
                                class="btn btn-primary rounded-pill px-4">
                                <i class="fas fa-save me-2"></i>{{ isEditMode ? 'Update Client' : 'Create Client' }}
                            </button>
                        </div>
                    </form>

                    <!-- Error Message -->
                    <div *ngIf="errorMessage" class="alert alert-danger mt-4">
                        {{ errorMessage }}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Loading State -->
<div *ngIf="isLoading" class="position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center" style="background: rgba(0,0,0,0.5); z-index: 9999;">
    <div class="spinner-border text-light" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
</div> 